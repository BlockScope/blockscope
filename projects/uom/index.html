<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- Primary Meta Tags -->
<meta name="title" content="Block Scope - Fresh coding and untangling knotty codebases.">
<meta name="description" content="Linking moves, deferring to the compilers.">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://blockscope.com/">
<meta property="og:title" content="Block Scope - Fresh coding and untangling knotty codebases.">
<meta property="og:description" content="Linking moves, deferring to the compilers.">
<meta property="og:image" content="https://blockscope.com/mstile-150x150.png">

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://blockscope.com/">
<meta property="twitter:title" content="Block Scope - Fresh coding and untangling knotty codebases.">
<meta property="twitter:description" content="Linking moves, deferring to the compilers.">
<meta property="twitter:image" content="https://blockscope.com/mstile-150x150.png">
<meta property="twitter:image-alt" content="Curly braces enclosing ellipsis">

        <title>Units of Measure</title>
        <link rel="stylesheet" href="../../css/app.css">
        <link rel="apple-touch-icon" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="manifest" href="../../site.webmanifest">
<link rel="mask-icon" href="../../safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

    </head>
    <body>
        <div class="container">
            <div class="row">
                <div id="side" class="col-3 card d-print-none">
                    <div class="card-body">
    <h1 class="card-title" title="block scope delimited with curlies">{<a href="../../">...</a>}</h1>

    <nav>
        <ul class="nav flex-column">
            <li class="nav-item"><a class="nav-link" href="../../projects/">projects</a></li>
            <li class="nav-item"><a class="nav-link" href="../../projects/uom/">&nbsp;units</a></li>
            <li class="nav-item"><a class="nav-link" href="../../projects/geodetics/">&nbsp;geodetics</a></li>
            <li class="nav-item"><a class="nav-link" href="../../projects/fly/">&nbsp;flight</a></li>
            <li class="nav-item"><a class="nav-link" href="../../projects/tooling/">&nbsp;tooling</a></li>
        </ul>
    </nav>
</div>

                </div>
                <div class="col-9">
                    <article>
    <header>
    <table>
        <tbody>
            <tr>
            <td style="padding-right: 1rem">
<pre class="sourceCode pre">
<code>
+
|
|
|
|
+
</code>
</pre>
            </td>
            <td>
                <div>
                    <h1 class="display-4">Units of Measure</h1>
                    
                    <p class="lead">We're not comparing apples and oranges, are we?</p>
                    
                </div>
            </td>
            </tr>
        </tbody>
    </table>
</header>

    
    <p>Professionally, I develop software applications. When I most needed better types for units I didn’t know that types could help with checking unit conformance and conversion.</p>
<p>At the time I joined a project<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> to commercialise a potato crop model it was coded in Borland Builder C++ and built one executable. This Windows GUI <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> desktop app, agronomists could use to setup and run the model. It had pickers for input files and a presentation layer for the results of the model run. I didn’t need the GUI elements as we would be delivering these via the web in the commercial product.</p>
<p>The model itself was not a lot of code and within a couple of days I was able to port it to standard C++ and then to C#. There were comments in places that mentioned units, mostly on numeric properties of classes. Even with those comments, as a developer without prior experience in this domain, I couldn’t step through the code and know what a sensible range would be for any variable I’d drag into the watch pane. When I ran the model I was getting different outputs than expected.</p>
<p>Familiar with the model, the research programmer at the institute had a good working knowledge of sensible ranges and pinpointed the problem quickly. Turned out to be a unit conversion error. A needle in a haystack problem for me, not a domain insider.</p>
<p>Later on, we used the <a href="https://en.wikipedia.org/wiki/Unified_Code_for_Units_of_Measure">unified code</a> for units as XML. That was some help but not type level help.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode xml"><code class="sourceCode xml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">&lt;?xml</span><span class="ot"> version=</span><span class="st">&quot;1.0&quot;</span><span class="ot"> encoding=</span><span class="st">&quot;ascii&quot;</span><span class="fu">?&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">root</span>&gt;</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>   &lt;<span class="kw">prefix</span><span class="ot"> Code=</span><span class="st">&quot;k&quot;</span><span class="ot"> CODE=</span><span class="st">&quot;K&quot;</span>&gt;</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">name</span>&gt;kilo&lt;/<span class="kw">name</span>&gt;</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">printSymbol</span>&gt;k&lt;/<span class="kw">printSymbol</span>&gt;</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">value</span><span class="ot"> value=</span><span class="st">&quot;1e3&quot;</span>&gt;1 <span class="dv">&amp;#215;</span> 10&lt;<span class="kw">sup</span>&gt;3&lt;/<span class="kw">sup</span>&gt;</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>      &lt;/<span class="kw">value</span>&gt;</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>   &lt;/<span class="kw">prefix</span>&gt;</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>   ...</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>   &lt;<span class="kw">base-unit</span><span class="ot"> Code=</span><span class="st">&quot;m&quot;</span><span class="ot"> CODE=</span><span class="st">&quot;M&quot;</span><span class="ot"> dim=</span><span class="st">&quot;L&quot;</span>&gt;</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">name</span>&gt;meter&lt;/<span class="kw">name</span>&gt;</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">printSymbol</span>&gt;m&lt;/<span class="kw">printSymbol</span>&gt;</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">property</span>&gt;length&lt;/<span class="kw">property</span>&gt;</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>   &lt;/<span class="kw">base-unit</span>&gt;</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>   &lt;<span class="kw">base-unit</span><span class="ot"> Code=</span><span class="st">&quot;s&quot;</span><span class="ot"> CODE=</span><span class="st">&quot;S&quot;</span><span class="ot"> dim=</span><span class="st">&quot;T&quot;</span>&gt;</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">name</span>&gt;second&lt;/<span class="kw">name</span>&gt;</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">printSymbol</span>&gt;s&lt;/<span class="kw">printSymbol</span>&gt;</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">property</span>&gt;time&lt;/<span class="kw">property</span>&gt;</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>   &lt;/<span class="kw">base-unit</span>&gt;</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>   &lt;<span class="kw">base-unit</span><span class="ot"> Code=</span><span class="st">&quot;g&quot;</span><span class="ot"> CODE=</span><span class="st">&quot;G&quot;</span><span class="ot"> dim=</span><span class="st">&quot;M&quot;</span>&gt;</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">name</span>&gt;gram&lt;/<span class="kw">name</span>&gt;</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">printSymbol</span>&gt;g&lt;/<span class="kw">printSymbol</span>&gt;</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">property</span>&gt;mass&lt;/<span class="kw">property</span>&gt;</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>   &lt;/<span class="kw">base-unit</span>&gt;</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>   ...</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>   &lt;<span class="kw">unit</span><span class="ot"> Code=</span><span class="st">&quot;Hz&quot;</span><span class="ot"> CODE=</span><span class="st">&quot;HZ&quot;</span><span class="ot"> isMetric=</span><span class="st">&quot;yes&quot;</span><span class="ot"> class=</span><span class="st">&quot;si&quot;</span>&gt;</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">name</span>&gt;Herz&lt;/<span class="kw">name</span>&gt;</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">printSymbol</span>&gt;Hz&lt;/<span class="kw">printSymbol</span>&gt;</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">property</span>&gt;frequency&lt;/<span class="kw">property</span>&gt;</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">value</span><span class="ot"> Unit=</span><span class="st">&quot;s-1&quot;</span><span class="ot"> UNIT=</span><span class="st">&quot;S-1&quot;</span><span class="ot"> value=</span><span class="st">&quot;1&quot;</span>&gt;1&lt;/<span class="kw">value</span>&gt;</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>   &lt;/<span class="kw">unit</span>&gt;</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>   &lt;<span class="kw">unit</span><span class="ot"> Code=</span><span class="st">&quot;N&quot;</span><span class="ot"> CODE=</span><span class="st">&quot;N&quot;</span><span class="ot"> isMetric=</span><span class="st">&quot;yes&quot;</span><span class="ot"> class=</span><span class="st">&quot;si&quot;</span>&gt;</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">name</span>&gt;Newton&lt;/<span class="kw">name</span>&gt;</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">printSymbol</span>&gt;N&lt;/<span class="kw">printSymbol</span>&gt;</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">property</span>&gt;force&lt;/<span class="kw">property</span>&gt;</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">value</span><span class="ot"> Unit=</span><span class="st">&quot;kg.m/s2&quot;</span><span class="ot"> UNIT=</span><span class="st">&quot;KG.M/S2&quot;</span><span class="ot"> value=</span><span class="st">&quot;1&quot;</span>&gt;1&lt;/<span class="kw">value</span>&gt;</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>   &lt;/<span class="kw">unit</span>&gt;</span></code></pre></div>
<p>In C# we parsed this and added some conversion functions. There has to be a better way, right? Well there is. F# has units of measure built in. They’re typed checked and erased. I’ve contributed to type checker plugins that help GHC, the Haskell compiler, with units of measure.</p>
<ul>
<li><p><code>adamgundry</code><a href="https://github.com/adamgundry/units-parser"><strong>/units-parser</strong></a><br />
<a href="https://github.com/adamgundry/units-parser/commit/9db2652bfbeea5d69f590ce15c171d7b9801bb60">Bump</a> expected test output for later ghc versions.</p></li>
<li><p><code>adamgundry</code><a href="http://hackage.haskell.org/package/uom-plugin"><strong>/uom-plugin</strong></a><br />
A compiler plugin for units of measure that I <a href="https://github.com/adamgundry/uom-plugin/graphs/contributors">contribute</a> to and use in flare-timing.</p></li>
<li><p><code>bgamari</code><a href="https://cs.brynmawr.edu/~rae/papers/2018/thoralf/thoralf.pdf"><strong>/the-thoralf-plugin</strong></a><br />
After seeing a presentation on this compiler plugin at the Haskell symposium 2018, I <a href="https://github.com/bgamari/the-thoralf-plugin/commits?author=philderbeast">fixed</a> some build warnings and got it compiling with ghc-8.6.1.</p></li>
<li><p><code>BlockScope</code><a href="https://github.com/BlockScope/plugins-for-blobs"><strong>/plugins-for-blobs</strong></a></p>
<blockquote>
<p>1 blob is equal to 1 lbf⋅s2/in, or 12 <a href="https://en.wikipedia.org/wiki/Slug_(unit)">slugs</a>.</p>
</blockquote>
<p>This is my attempt to refactor the <a href="https://github.com/bgamari/the-thoralf-plugin">thoralf-plugin</a> and the <a href="https://github.com/adamgundry/uom-plugin">uom-plugin</a> so that they share something in common and so that the former reaches parity with the later in units of measure.</p></li>
</ul>
<section class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>Crop Logic, a now defunct startup spun out of a research institute.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>A graphical user interface.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
</article>

                </div>
            </div>
        </div>
    </body>
</html>
